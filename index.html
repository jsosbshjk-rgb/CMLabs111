<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Таблиця замовлень CM Labs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.5;
            background-color: #121212;
            color: #e0e0e0;
        }
        h1 {
            color: #ffffff;
            text-align: center;
        }
        .date-row {
            margin: 20px 0;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .date-row label {
            font-weight: bold;
            color: #bbbbbb;
        }
        input[type="date"] {
            padding: 8px 12px;
            font-size: 16px;
            background-color: #2d2d2d;
            color: #ffffff;
            border: 1px solid #555;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #1e1e1e;
            color: #e0e0e0;
        }
        th, td {
            border: 1px solid #444;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #2a2a2a;
            color: #ffffff;
        }
        .category {
            background-color: #252525;
            font-weight: bold;
            text-align: center;
            font-size: 1.1em;
            color: #ffffff;
        }
        input[type="number"] {
            width: 90px;
            padding: 6px;
            font-size: 16px;
            text-align: center;
            background-color: #2d2d2d;
            color: #ffffff;
            border: 1px solid #555;
        }
        .profit {
            color: #66ff99;
            font-weight: bold;
            font-size: 1.05em;
        }
        #netProfit {
            font-size: 1.7em;
            font-weight: bold;
            background-color: #1a3a1a;
            color: #88ffaa;
            padding: 14px;
            text-align: right;
            border-radius: 6px;
            margin-top: 20px;
        }
        tfoot tr {
            background-color: #1e1e1e;
        }
    </style>
</head>
<body>

<h1>Таблиця замовлень CM Labs</h1>

<div class="date-row">
    <label for="orderDate">Дата заповнення таблиці:</label>
    <input type="date" id="orderDate" name="orderDate">
</div>

<table id="orderTable">
    <thead>
        <tr>
            <th>№</th>
            <th>Товар</th>
            <th>Ціна продажу (₴)</th>
            <th>Собівартість (₴)</th>
            <th>Кількість</th>
            <th class="profit">Чистий дохід (₴)</th>
        </tr>
    </thead>
    <tbody>

        <!-- Кава свіжообсмажена -->
        <tr class="category"><td colspan="6">Кава свіжообсмажена</td></tr>
        <tr data-id="1">
            <td>1</td>
            <td>IMPERIAL</td>
            <td data-price="1000">1000</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="2">
            <td>2</td>
            <td>TONIC</td>
            <td data-price="1000">1000</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="3">
            <td>3</td>
            <td>DOMINION</td>
            <td data-price="1600">1600</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>

        <!-- Набори кавомана -->
        <tr class="category"><td colspan="6">Набори кавомана</td></tr>
        <tr data-id="4">
            <td>4</td>
            <td>Набір кавомана для Delonghi (XL)</td>
            <td data-price="3500">3500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="5">
            <td>5</td>
            <td>Набір кавомана для Delonghi (L)</td>
            <td data-price="3100">3100</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="6">
            <td>6</td>
            <td>Набір кавомана для Saeco Philips (XL)</td>
            <td data-price="3450">3450</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="7">
            <td>7</td>
            <td>Набір кавомана для Saeco Philips (L)</td>
            <td data-price="3050">3050</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="8">
            <td>8</td>
            <td>Набір кавомана JURA / KRUPS</td>
            <td data-price="3100">3100</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="9">
            <td>9</td>
            <td>Набір кавомана Nivona / Miele / Melitta</td>
            <td data-price="3300">3300</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="10">
            <td>10</td>
            <td>Набір кавомана для ріжкових кавоварок</td>
            <td data-price="1800">1800</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>

        <!-- Засоби чищення -->
        <tr class="category"><td colspan="6">Засоби чищення</td></tr>
        <tr data-id="11">
            <td>11</td>
            <td>Концентрат для видалення накипу 1л</td>
            <td data-price="1100">1100</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="12">
            <td>12</td>
            <td>Milk cleaner 0.5л</td>
            <td data-price="400">400</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="13">
            <td>13</td>
            <td>Таблетки для видалення кавових смол 50 шт</td>
            <td data-price="600">600</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="14">
            <td>14</td>
            <td>Порошок Coffee cleaner 1 кг</td>
            <td data-price="700">700</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="15">
            <td>15</td>
            <td>Декальцинат (одноразовий)</td>
            <td data-price="200">200</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="16">
            <td>16</td>
            <td>Редукційне мастило для Delonghi</td>
            <td data-price="200">200</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="17">
            <td>17</td>
            <td>Харчове мастило</td>
            <td data-price="200">200</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>

        <!-- Сиропи до кави -->
        <tr class="category"><td colspan="6">Сиропи до кави (700 мл, якщо не вказано інше)</td></tr>
        <tr data-id="18">
            <td>18</td>
            <td>Набір сиропів Coffee Set 6 шт по 40 мл</td>
            <td data-price="600">600</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="19">
            <td>19</td>
            <td>Сироп Ваніль (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="20">
            <td>20</td>
            <td>Сироп Карамель (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="21">
            <td>21</td>
            <td>Сироп Горіх (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="22">
            <td>22</td>
            <td>Сироп Шоколад (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="23">
            <td>23</td>
            <td>Сироп Ірландський крем (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="24">
            <td>24</td>
            <td>Сироп Солона карамель (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="25">
            <td>25</td>
            <td>Сироп Маракуя (700 мл)</td>
            <td data-price="500">500</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="26">
            <td>26</td>
            <td>Сироп Кленовий (700 мл)</td>
            <td data-price="360">360</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>

        <!-- Запчастини -->
        <tr class="category"><td colspan="6">Запчастини</td></tr>
        <tr data-id="27">
            <td>27</td>
            <td>Ремкомплект групи заварювання Delonghi L</td>
            <td data-price="350">350</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="28">
            <td>28</td>
            <td>Ремкомплект групи заварювання Delonghi XL</td>
            <td data-price="700">700</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="29">
            <td>29</td>
            <td>Ремкомплект групи заварювання Philips / Saeco XL</td>
            <td data-price="700">700</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="30">
            <td>30</td>
            <td>Ремкомплект групи заварювання Philips / Saeco L</td>
            <td data-price="350">350</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="31">
            <td>31</td>
            <td>Ремкомплект групи заварювання Saeco / Magic / Royal / Stratos L</td>
            <td data-price="350">350</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="32">
            <td>32</td>
            <td>Ремкомплект групи заварювання Nivona XL</td>
            <td data-price="1000">1000</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>
        <tr data-id="33">
            <td>33</td>
            <td>Ремкомплект помпи Ulka EX5, EP5</td>
            <td data-price="300">300</td>
            <td><input type="number" min="0" step="0.01" value="0" class="cost-input"></td>
            <td><input type="number" min="0" value="0" class="qty"></td>
            <td class="profit">0.00</td>
        </tr>

    </tbody>
    <tfoot>
        <tr>
            <td colspan="5" style="text-align:right; font-weight:bold;">ЧИСТИЙ ПРИБУТОК:</td>
            <td id="netProfit">0.00 ₴</td>
        </tr>
    </tfoot>
</table>

<script>
// ────────────────────────────────────────────────
// Збереження та відновлення даних
// ────────────────────────────────────────────────

const STORAGE_KEY = 'cm-labs-order-table-data';
const DATE_KEY = 'cm-labs-order-date';

// Завантаження збережених даних при старті
window.addEventListener('load', () => {
    // Дата
    const savedDate = localStorage.getItem(DATE_KEY);
    if (savedDate) {
        document.getElementById('orderDate').value = savedDate;
    } else {
        document.getElementById('orderDate').value = new Date().toISOString().split('T')[0];
    }

    // Таблиця
    const savedData = localStorage.getItem(STORAGE_KEY);
    if (savedData) {
        const data = JSON.parse(savedData);
        document.querySelectorAll('tbody tr[data-id]').forEach(row => {
            const id = row.getAttribute('data-id');
            if (data[id]) {
                row.querySelector('.cost-input').value = data[id].cost || 0;
                row.querySelector('.qty').value = data[id].qty || 0;

                // перерахунок рядка
                const price = parseFloat(row.querySelector('[data-price]').getAttribute('data-price')) || 0;
                const cost = parseFloat(row.querySelector('.cost-input').value) || 0;
                const qty = parseFloat(row.querySelector('.qty').value) || 0;
                row.querySelector('.profit').textContent = ((price - cost) * qty).toFixed(2);
            }
        });
        calculateTotal();
    }
});

// Збереження при зміні
function saveData() {
    const data = {};
    document.querySelectorAll('tbody tr[data-id]').forEach(row => {
        const id = row.getAttribute('data-id');
        data[id] = {
            cost: row.querySelector('.cost-input').value || '0',
            qty: row.querySelector('.qty').value || '0'
        };
    });
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));

    // дата
    localStorage.setItem(DATE_KEY, document.getElementById('orderDate').value);
}

function updateRow() {
    const row = this.closest('tr');
    const price = parseFloat(row.querySelector('[data-price]').getAttribute('data-price')) || 0;
    const cost = parseFloat(row.querySelector('.cost-input').value) || 0;
    const qty = parseFloat(row.querySelector('.qty').value) || 0;
    row.querySelector('.profit').textContent = ((price - cost) * qty).toFixed(2);
    calculateTotal();
    saveData();
}

function calculateTotal() {
    let sum = 0;
    document.querySelectorAll('.profit').forEach(el => {
        sum += parseFloat(el.textContent) || 0;
    });
    document.getElementById('netProfit').textContent = sum.toFixed(2) + ' ₴';
}

// Прив'язка подій
document.querySelectorAll('.qty, .cost-input').forEach(input => {
    input.addEventListener('input', updateRow);
    input.addEventListener('change', updateRow);
});
document.getElementById('orderDate').addEventListener('change', saveData);
</script>

</body>
</html>
